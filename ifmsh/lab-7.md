---
layout: default_no_header
title: Лабораторная работа 7
---

> — Ты чем занимаешься?  
> — Программы пишу!  
> — А слабо написать про килограммы?! 

## Теория

Придумать текст, заполняющий сайт или программу просто, однако делать это самому сложно и долго, потому, иногда, для упрощения 
жизни программиста приходится использовать внешние источники/сервисы и их API для получения
информации, которая позволит собрать статистику или просто добавить "внутренностей"... Что такое API? 

**API (Application programming interface)** — программный интерфейс приложения или же некий набор функций, который позволяет
взаимодействовать с приложением. Например, если программисту требуется встроить предложения по поиску второй половинки на сайт,
то ему не требуется создавать приложение похожее на Tinder. Ему достаточно взять API такого приложения и с помощью простых запросов
получить всю информацию о людях рядом с вами и готовых приехать прямо сейчас.

Рассмотрим такой функционал на примере API сайта с [числами](http://numbersapi.com). Данный сервис
позволяет получать данные о числе используя простой язык запросов. Например, если ввести в браузере запрос вида 
`http://numbersapi.com/10`, то вы получите информацию о числе или историю связанную с числом. Если брать из примера, то для числа 10
мы получаем `10 is the number of fingers on a pair of human hands.`. А если добавить в конце `/date`, то получим информацию о 
дате (связанной с числом).

## Задача

Задача будет выглядеть немного просто, однако оцениваться она будет комплексно и насколько вы глубоко погрузились в тему.
От вас требуется найти и получить информацию о неком API. Исследовать его возможности и расписать это в отчет. Однако задача 
этим не ограничивается. После анализа требуется создать приложение-обертку, которое позволит не вникая в API получить какую-либо 
информацию (например, информация по числам, с возможностью переключения тематики, как было с датой). API чисел использовать уже нельзя.

Оценивание будет по следующим параметрам (оценки могут быть дробными):

- **Заинтересованность** — насколько вы погрузились в тему
- **Отчет** — насколько хорошо написан отчет
- **Программа** — насколько удобна программа для пользователя и сколько возможностей вы добавили
- **Сложность API** — чем выше сложность, тем выше оценка
- **Польза** — насколько полезны процесс исследования API, процесс написания программы и сама программа

Под программой подразумевается написание либо консольного приложения, либо программы с графическим интерфейсом.

API можно найти самим, а можно подглядеть [тут](https://github.com/public-apis/public-apis). 
Нельзя выбирать одно API сразу на нескольких, если вы выбрали, то напишите мне, я его вам подтвержу. Работа в команде возможна (до 2 человек), но
в таком случае решение должно быть намного сложнее (API сложнее, программа краше).

### Пример

В большинстве случаев вам придется работать с запросами в интернет (если только там не готовая обертка под язык программирования). 
Пример будет написан на языке Python. Для этого понадобится использовать модуль `requests`. Для работы с ним требуется его установить.
Например, командой `pip install requests`. Если вы работаете в браузерном редакотре кода, то он может автоматически скачать и установить пакет.

```python
import requests

response = requests.get('http://numbersapi.com/random/year')
print(response.text)
```

Результат данной программы

```
797 is the year that Irene of Athens orders her son, Byzantine Emperor Constantine VI, captured and deposed on July 17th.
```

Улучшим программу, добавим возможность просматривать указанный год и выходить если укажет пользователь.

```python
import requests

print("Программа для получения информации по году!")
year = input("Введите год ('exit' если хотите остановить программу): ")
while year != "exit":
    response = requests.get(f'http://numbersapi.com/{year}/year')
    print(response.text)
    year = input("Год/exit: ")
input("Пока! Нажмите Enter, чтобы выйти!")
```

Пример работы программы:
```
Программа для получения информации по году!
Введите год ('exit' если хотите остановить программу): 2015
2015 is the year that the winning nation for the 2022 Winter Olympics will be announced by the IOC.
Год/exit: 2000
2000 is the year that Israel's prime minister Ehud Barak and PLO head Yasser Arafat meet at Camp David, but fail to reach an agreement on July–July 25 13th.
Год/exit: exit
Пока! Нажмите Enter, чтобы выйти!
```

От вас требуется что-то сложнее этого.

### Бонус

Иногда API возвращает не текст, а json-ответ, который представляет собой специальную структуру в формате json. В таком случае требуется
обрабатывать данные по другому, а не просто выводить. API чисел позволяет получать в json формате.

```python
import requests

year = 2000
response = requests.get(f'http://numbersapi.com/{year}/year?json')
print(response.text)
```

В таком случае результат будет не просто строкой, а структурой:

```
{
 "date": "May 17",
 "text": "2000 is the year that a bomb in Glorietta Mall in Makati City, Philippines injures 13 on May 17th.",
 "number": 2000,
 "found": true,
 "type": "year"
}
```

Для получения структуры (например, в виде словаря), а не текста, требуется использовать метод `.json()`. Он трансформирует
ответ в формат, который может обработать язык программирования.

```python
import requests

year = 2000
response = requests.get(f'http://numbersapi.com/{year}/year?json')
data = response.json()
print(data)
print(data['date'], year)
print(data['text'])
```

```
{'date': 'August 14', 'text': '2000 is the year that Tsar Nicholas II and his family are canonized by the synod of the Russian Orthodox Church on August 14th.', 'number': 2000, 'found': True, 'type': 'year'}
August 14 2000
2000 is the year that Tsar Nicholas II and his family are canonized by the synod of the Russian Orthodox Church on August 14th.
```

Однако далеко не всегда в ответе будут присутствовать поля из примера выше. Например, поле date может быть пропущено. Для своей безопасности изучите
API или же используйте проверки либо с помощью `if ... else ...`, либо с помощью методов словаря (например, метод `.get(<key>, <default>)` позволяет
получить значение по ключу, а если ключа нет в словаре, то он возвращает значение по умолчанию или же второй параметр).